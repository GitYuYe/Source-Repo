---
title: PHP 正则判断中文
date: 2018-03-19 10:01:00
categories: PHP
tags: PHP
---
​	汉字一定注意是gbk还是utf8编码

UTF-8匹配:在javascript中，要判定字符串是中文是很简朴的。比如：var str = "php编程";if (/^[\u4e00-\u9fa5]+$/.test(str)) {alert("该字符串全部是中文");} else{alert("该字符串不全部是中文");}php中，是用 ...

　　UTF-8匹配:

　　在javascript中，要判定字符串是中文是很简朴的。比如：

　　var str = "php编程";

　　if (/^[\u4e00-\u9fa5]+$/.test(str)) {

　　alert("该字符串全部是中文");

　　}

　　else{

　　alert("该字符串不全部是中文");

　　}

　　php中，是用\x表示十六进制数据的。于是，变换成如下的代码：

　　$str = "php编程";

　　if (preg_match("/^[\x4e00-\x9fa5]+$/"$str)) {

　　print("该字符串全部是中文");

　　} else {

　　print("该字符串不全部是中文");

　　}

　　貌似不报错了，判定的结果也准确，不过把$str换成“编程”两字，结果却还是显示“该字符串不全部是中文”，看来这样的判定还是不够准确。

　　网上只能找到匹配全角字符的正则: ^[\x80-\xff]*^/

　　[\u4e00-\u9fa5]可以匹配中文但是PHP又不支持

　　可能还跟编码有关系，因此需要了解一下模式修正符的相关知识.

　　在一篇《模式修正符》的文章中了解到：

　　u (PCRE_UTF8)

　　此修正符启用了一个 PCRE 中与 Perl 不兼容的额外功能。模式字符串被当成 UTF-8。本修正符在 Unix 下自 PHP 4.1.0 起可用，在 win32 下自 PHP 4.2.3 起可用。

　　例子:

　　preg_match('/[\x{2460}-\x{2468}]/u' $str); 匹配 内码汉字

　　按照他提供的方式进行测试，代码如下：

　　$str = "php编程";

　　if (preg_match("/^[\x{2460}-\x{2468}]+$/u"$str)) {

　　print("该字符串全部是中文");

　　} else {

　　print("该字符串不全部是中文");

　　}

　　发现这次依然对是否为中文判定失常。

　　不过，既然\x表示的十六进制数据，为什么和js里边提供的范围\x4e00-\x9fa5不一样呢?于是我就换成了下边的代码发现真的准确了：

　　$str = "php编程";

　　if (preg_match("/^[\x{4e00}-\x{9fa5}]+$/u"$str)) {

　　print("该字符串全部是中文");

　　} else {

　　print("该字符串不全部是中文");

　　}

　　知道了php中utf-8编码下用正则表达式匹配汉字的最终准确表达式——/^[\x{4e00}-\x{9fa5}]+$/u，

　　参考以上文章写了如下一段测试代码(复制以下代码保存成.php文件)

　　输入字符(数字字母汉字下划线):

　　GBK:

　　preg_match("/^[".chr(0xa1)."-".chr(0xff)."A-Za-z0-9_]+$/"$str); //GB2312汉字字母数字下划线正则表达式

 

 

 

本文章总结了php中利用正则表达式来匹配中文的一些实例函数，有需要的朋友可参考参考。

我们先要明白
中文双字节字符编码范围

\1. GBK (GB2312/GB18030)
x00-xff GBK双字节编码范围
x20-x7f ASCII
xa1-xff 中文 gb2312
x80-xff 中文 gbk

\2. UTF-8 (Unicode)

u4e00-u9fa5 (中文)
x3130-x318F (韩文
xAC00-xD7A3 (韩文)
u0800-u4e00 (日文)

获取指定的中文与字符
例1

| 代码如下                                                     | 复制代码 |
| ------------------------------------------------------------ | -------- |
| <?php $str = '正则如何匹配中文字在某中文字符串中？'; preg_match("/中/",$str,$regs); print_r($regs); ?> |          |

输出
Array
(
    [0] => 中
)

例2

| 代码如下                                                     | 复制代码 |
| ------------------------------------------------------------ | -------- |
| <?php $str = '这里是中文 this is English'; //把中文变成红色 echo preg_replace("/([x80-xff].)/","<font color=red>1</font>",$str); //把非中文变成红色 echo preg_replace("/([x20-x7f])/","<font color=red>1</font>",$str); ?> |          |

签里面有中文、英文、数字等混排，则需要对汉字进行特殊处理，由于PCRE不支持U P L之类的perl字符串处理转义，使用16进制或者Unicode进行处理，范例如下：

| 代码如下                                                     | 复制代码 |
| ------------------------------------------------------------ | -------- |
| $str = "之二宽阔的甘家口东#标签1#标签2 #标签3。#标签4,都发$1234 ￥xc,cvm , ￥12,dflksjf如何#标签5.x #tag6.cvxcv“"; preg_match_all('/#([a-zA-Z0-9x7f-xff]+)/', $str, $mat); print_r($mat);preg_match("/[x{00a5}x{ffe5}](d+)/u", $str, $mat); print_r($mat); |          |

最后我明白了php中utf-8编码下用正则表达式匹配汉字的最终正确表达式——/^[x{4e00}-x{9fa5}]+$/u

| 代码如下                                                     | 复制代码 |
| ------------------------------------------------------------ | -------- |
| $str = "php编程"; if (preg_match("/^[x{4e00}-x{9fa5}]+$/u",$str)) { print("该字符串全部是中文"); } else { print("该字符串不全部是中文"); } |          |

实例

下面这款匹配中文字符串正则表达式是一款利用数组，然后 多次for把全是中文字符串的打印出来。
*/

| 代码如下                                                     | 复制代码 |
| ------------------------------------------------------------ | -------- |
| $str_arr = array( "iameverysorry", "快乐编程，快乐生活", "php教程编程", "1997年香港回归", "英语学习abc", "www.php100.com" );$patt_ch = chr(0xa1) . "-" . chr(0xff);foreach ($str_arr as $str) {     echo "字符串'$str' 是";     if (preg_match("/^[$patt_ch]+$/", $str))     {         echo "<b>完全中文</b>";         echo "<br>";         echo "<br>";     }     else     {         echo "非完全中文";         echo "<br>";         echo "<br>";     } } |          |